<aura:component  controller="PropertyDetails" implements="flexipage:availableForAllPageTypes,forceCommunity:availableForAllPageTypes"  access="global" >
    <aura:attribute name="propertyList" type="Property__c[]"></aura:attribute>
     <aura:attribute name="propertiesFound" type="boolean" default="false"></aura:attribute>
     <aura:attribute name="openOwnerDetails" type="boolean" default ="false"></aura:attribute>
     <aura:attribute name="proOwnerId" type="String"></aura:attribute>
     <aura:attribute name="propertyId" type="String"></aura:attribute>
     <aura:attribute name="openEnquieryDetails" type="boolean" default="false"></aura:attribute>
    <aura:handler name="init" value="{!this}" action="{!c.fetchAllProperty}"/>    
  <!-- Navigation Start-->
    <lightning:navigation aura:id="navService"></lightning:navigation>
    <aura:attribute name="pageReference" type="object"></aura:attribute>
    <aura:attribute name="url" type="string"></aura:attribute>
  <!-- Navigation End-->
  <aura:handler name="ctrlf_propertyFilterEvent" event="c:ctrlf_PropertyFilterEvent" action="{!c.handlePropertyFilter}"/>
  <c:ctrlf_propertyFilter ></c:ctrlf_propertyFilter>
     <aura:if isTrue="{!v.propertiesFound}">
        <lightning:layout multipleRows="true">
          <aura:iteration items="{!v.propertyList}" var="pro">
            <lightning:layoutItem size="6" padding="around-small">
                <lightning:layout multipleRows="true">
                  <div class="slds-box" style="width:100%;background-color:white;">
                      <lightning:layout multipleRows="true">
                        <lightning:layoutItem size="4" padding="around-small" >
                          <lightning:formattedRichText value="{!pro.Property_Main_Image__c}"></lightning:formattedRichText>
                        </lightning:layoutItem>   
                        <lightning:layoutItem size="8" padding="around-small">
                            <lightning:card title="{!pro.Furnished_Type__c}">
                              <lightning:layoutItem size="12">
                                  <p style="color:red">INR: {!pro.Rent__c}</p>
                              </lightning:layoutItem>
                              <lightning:layoutItem size="12">
                                <p >{!pro.No_Of_Bathroom__c} BHK house for Rent {!pro.Covered_Area_sqft__c} sqft</p>
                              </lightning:layoutItem>
                              <lightning:layoutItem size="12">
                              <p>{!pro.Area__c}</p>
                              </lightning:layoutItem>
                              <lightning:layoutItem size="12">
                                <p>{!pro.No_of_Bedroom__c} Room {!pro.No_Of_Bathroom__c} Bathroom {!pro.Furnished_Type__c}</p>
                                </lightning:layoutItem>
                          </lightning:card> 

                          <div class="slds-p-top_small">
                            <lightning:buttonGroup>
                                <lightning:button class="btnStyle" variant="success" label="Owner Details"
                                                  value ="{!pro.Property_Owner__c}" onclick="{!c.ownerDetailsClick}"
                                >
                                </lightning:button>
                                <lightning:button class="btnStyle" variant="success" label="Enquiry"
                                value ="{!pro.Id}" onclick="{!c.feedbackClicked}"
                                >         
                                </lightning:button>
                                <lightning:button class="btnStyle" variant="success" label="Property Details"
                                                  value ="{!pro.Id}" onclick="{!c.NavigateToProDetails}"
                                >
                                </lightning:button>
                            </lightning:buttonGroup>
                          </div>
                        </lightning:layoutItem>      
                      </lightning:layout>
                  </div>
                </lightning:layout>
            </lightning:layoutItem>
          </aura:iteration>
        </lightning:layout>
    <aura:set attribute="else">
      	<span>The property is not listed yet. Please stay tune</span>
    </aura:set>
    
  </aura:if> 

  <!-- Owner Detail Section Start-->
    <aura:if isTrue="{!v.openOwnerDetails}">
      <div style="margin-top:5%;"> 
        <section role="dialog" tabindex="1" class ="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
              <header class="slds-modal__header">
                  <lightning:card title="Property Owner Details" iconName="standard:people">
                      <lightning:buttonIcon class="slds-modal__close" iconName="utility:close" onclick="{!c.closeOwnerModal}">

                      </lightning:buttonIcon>
                  </lightning:card>

              </header>
              <div class="slds-modal__content slds-p-around_medium">
                <c:ctrlf_MyPropertyOwner propertyOwnerId="{!v.proOwnerId}"></c:ctrlf_MyPropertyOwner>   

              </div>
            </div>
        </section>
      </div>
    </aura:if>

<!-- Property Enquiery section start-->

<aura:if isTrue="{!v.openEnquieryDetails}">

  <div style="margin-top:5%">

  <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open">

        <div class="slds-modal__container">

          <header class="slds-modal__header">

              <lightning:buttonIcon  class="slds-modal__close" iconName="utility:close"

                                            onclick="{!c.closeEnquieryModal}"></lightning:buttonIcon>

              </header>

              <div class="slds-modal__content slds-p-around_medium" >

              <c:ctrlf_MyPropertyEnquiry propertyId="{!v.propertyId}"></c:ctrlf_MyPropertyEnquiry>

              </div>

          </div>
      </section>   

  </div>

</aura:if>

</aura:component>